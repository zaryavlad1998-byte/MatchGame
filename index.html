<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –ò–≥—Ä–∞</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin: 0; padding: 0; overflow-x: hidden; }
    * { box-sizing: border-box; }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    input[type="number"] { -moz-appearance: textfield; }
    .home-button { transition: all 0.3s ease; }
    .home-button:hover { transform: scale(1.1); }
    .home-button:active { transform: scale(0.95); }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback, useMemo } = React;

    function MultiplicationGame() {
      const [gameState, setGameState] = useState('setup');
      const [totalRounds, setTotalRounds] = useState(10);
      const [operations, setOperations] = useState({
        multiply: true,
        divide: false,
        add: false,
        subtract: false
      });

      const [difficulty, setDifficulty] = useState('easy');

      const [num1, setNum1] = useState(0);
      const [num2, setNum2] = useState(0);
      const [currentOperation, setCurrentOperation] = useState('√ó');
      const [answer, setAnswer] = useState('');
      const [score, setScore] = useState(0);
      const [currentRound, setCurrentRound] = useState(0);
      const [message, setMessage] = useState('');
      const [soundEnabled, setSoundEnabled] = useState(true);
      const [attempts, setAttempts] = useState(2);
      const [lives, setLives] = useState(2);
      const [gameHistory, setGameHistory] = useState([]);

      const audioContextRef = useRef(null);

      useEffect(() => {
        try {
          audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
          console.log('Audio not supported');
        }
      }, []);

      const speak = useCallback((text) => {
        if (!soundEnabled) return;
        try {
          window.speechSynthesis.cancel();
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = 'ru-RU';
          utterance.rate = 0.9;
          utterance.pitch = 1.2;
          utterance.volume = 1;
          window.speechSynthesis.speak(utterance);
        } catch (e) {
          console.log('Speech not supported');
        }
      }, [soundEnabled]);

      const playSound = useCallback((frequency, duration, type = 'sine') => {
        if (!soundEnabled || !audioContextRef.current) return;
        try {
          const ctx = audioContextRef.current;
          const oscillator = ctx.createOscillator();
          const gainNode = ctx.createGain();
          oscillator.connect(gainNode);
          gainNode.connect(ctx.destination);
          oscillator.frequency.value = frequency;
          oscillator.type = type;
          gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);
          oscillator.start(ctx.currentTime);
          oscillator.stop(ctx.currentTime + duration);
        } catch (e) {
          console.log('Sound error:', e);
        }
      }, [soundEnabled]);

      const playCorrectSound = useCallback(() => {
        playSound(523.25, 0.1);
        setTimeout(() => playSound(659.25, 0.1), 100);
        setTimeout(() => playSound(783.99, 0.2), 200);
      }, [playSound]);

      const playWrongSound = useCallback(() => {
        playSound(200, 0.3, 'sawtooth');
      }, [playSound]);

      const toggleOperation = useCallback((op) => {
        setOperations(prev => {
          const newOps = { ...prev, [op]: !prev[op] };
          const hasAtLeastOne = Object.values(newOps).some(v => v);
          return hasAtLeastOne ? newOps : prev;
        });
      }, []);

      const goHome = useCallback(() => {
        if (gameState === 'playing') {
          const confirmed = window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏? –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω.');
          if (!confirmed) return;
        }
        setGameState('setup');
        setScore(0);
        setCurrentRound(0);
        setGameHistory([]);
        setMessage('');
        setAnswer('');
      }, [gameState]);

      const randInt = useCallback((min, max) => {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }, []);

      const getRanges = useCallback((op) => {
        if (difficulty === 'easy') {
          if (op === '√ó' || op === '√∑') return { aMin: 2, aMax: 9, bMin: 2, bMax: 9 };
          return { aMin: 1, aMax: 10, bMin: 1, bMax: 10 };
        }
        if (difficulty === 'medium') {
          if (op === '√ó' || op === '√∑') return { aMin: 2, aMax: 12, bMin: 2, bMax: 12 };
          return { aMin: 5, aMax: 50, bMin: 5, bMax: 50 };
        }
        if (op === '√ó' || op === '√∑') return { aMin: 3, aMax: 20, bMin: 3, bMax: 20 };
        return { aMin: 10, aMax: 100, bMin: 10, bMax: 100 };
      }, [difficulty]);

      const generateQuestion = useCallback((incrementRound = false) => {
        if (incrementRound) setCurrentRound(prev => prev + 1);

        const activeOps = [];
        if (operations.multiply) activeOps.push('√ó');
        if (operations.divide) activeOps.push('√∑');
        if (operations.add) activeOps.push('+');
        if (operations.subtract) activeOps.push('‚àí');

        const op = activeOps[Math.floor(Math.random() * activeOps.length)];
        setCurrentOperation(op);

        let n1, n2;

        if (op === '√∑') {
          const r = getRanges(op);
          const divisor = randInt(r.bMin, r.bMax);
          const result = randInt(r.aMin, r.aMax);
          n1 = divisor * result;
          n2 = divisor;
        } else if (op === '‚àí') {
          const r = getRanges(op);
          n1 = randInt(r.aMin, r.aMax);
          n2 = randInt(r.bMin, r.bMax);
          if (n2 > n1) {
            const tmp = n1;
            n1 = n2;
            n2 = tmp;
          }
        } else {
          const r = getRanges(op);
          n1 = randInt(r.aMin, r.aMax);
          n2 = randInt(r.bMin, r.bMax);
        }

        setNum1(n1);
        setNum2(n2);
        setAnswer('');
        setMessage('');
        setAttempts(1);
        setLives(2);
      }, [operations, getRanges, randInt]);

      const startGame = useCallback(() => {
        setGameState('playing');
        setScore(0);
        setCurrentRound(0);
        setGameHistory([]);
        setMessage('');
        generateQuestion();
      }, [generateQuestion]);

      const calculateCorrectAnswer = useCallback(() => {
        switch (currentOperation) {
          case '√ó': return num1 * num2;
          case '√∑': return num1 / num2;
          case '+': return num1 + num2;
          case '‚àí': return num1 - num2;
          default: return 0;
        }
      }, [currentOperation, num1, num2]);

      const showResults = useCallback(() => {
        setGameState('results');
      }, []);

      const checkAnswer = useCallback(() => {
        const userAnswer = parseInt(answer);
        const correctAnswer = calculateCorrectAnswer();
        const isCorrect = userAnswer === correctAnswer;
        const questionKey = `${num1} ${currentOperation} ${num2}`;

        if (isCorrect) {
          playCorrectSound();
          speak('–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢—ã –º–æ–ª–æ–¥–µ—Ü!');
          setScore(prev => prev + 1);
          setMessage('üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢—ã –º–æ–ª–æ–¥–µ—Ü!');

          setGameHistory(prev => {
            const existingWrong = prev.find(h => h.question === questionKey && h.hadMistake === true);
            if (existingWrong) {
              return prev.map(h =>
                h.question === questionKey
                  ? { ...h, solvedCorrectlyAfter: userAnswer }
                  : h
              );
            }
            return [...prev, {
              question: questionKey,
              userAnswer,
              correctAnswer,
              isCorrect: true,
              wrongAnswers: [],
              hadMistake: false
            }];
          });

          const nextRound = currentRound + 1;
          if (nextRound >= totalRounds) {
            setTimeout(showResults, 2000);
          } else {
            setTimeout(() => generateQuestion(true), 2000);
          }
        } else {
          if (attempts > 0) {
            playWrongSound();
            speak('–ü–æ–¥—É–º–∞–π –µ—â—ë');
            setAttempts(prev => prev - 1);
            setLives(prev => prev - 1);
            setMessage('ü§î –ü–æ–¥—É–º–∞–π –µ—â—ë');

            setGameHistory(prev => {
              const existingEntry = prev.find(h => h.question === questionKey);
              const wrongAnswers = existingEntry?.wrongAnswers ? [...existingEntry.wrongAnswers, userAnswer] : [userAnswer];
              const filtered = prev.filter(h => h.question !== questionKey);
              return [...filtered, {
                question: questionKey,
                userAnswer,
                correctAnswer,
                isCorrect: false,
                wrongAnswers,
                hadMistake: true
              }];
            });

            setAnswer('');
          } else {
            playWrongSound();
            speak(`–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç ${correctAnswer}`);
            setMessage(`‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}`);

            setGameHistory(prev => {
              const existingEntry = prev.find(h => h.question === questionKey);
              const wrongAnswers = existingEntry?.wrongAnswers ? [...existingEntry.wrongAnswers, userAnswer] : [userAnswer];
              const filtered = prev.filter(h => h.question !== questionKey);
              return [...filtered, {
                question: questionKey,
                userAnswer,
                correctAnswer,
                isCorrect: false,
                wrongAnswers,
                hadMistake: true
              }];
            });

            const nextRound = currentRound + 1;
            if (nextRound >= totalRounds) {
              setTimeout(showResults, 2500);
            } else {
              setTimeout(() => generateQuestion(true), 2500);
            }
          }
        }
      }, [answer, calculateCorrectAnswer, num1, num2, currentOperation, attempts, currentRound, totalRounds, playCorrectSound, playWrongSound, speak, showResults, generateQuestion]);

      const handleKeyPress = useCallback((e) => {
        if (e.key === 'Enter' && answer !== '') checkAnswer();
      }, [answer, checkAnswer]);

      const resetGame = useCallback(() => {
        setGameState('setup');
        setTotalRounds(10);
        setScore(0);
        setCurrentRound(0);
        setGameHistory([]);
        setMessage('');
        setAnswer('');
      }, []);

      const firstTryCorrectCount = useMemo(() => {
        return gameHistory.filter(item => item.hadMistake === false && item.isCorrect === true).length;
      }, [gameHistory]);

      const percentage = useMemo(() => {
        return totalRounds > 0 ? Math.round((firstTryCorrectCount / totalRounds) * 100) : 0;
      }, [firstTryCorrectCount, totalRounds]);

      const mathBg = useMemo(() => ({
        backgroundImage: `url("image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='5' y='20' font-size='20' fill='%23e0e7ff' opacity='0.3'%3E+%3C/text%3E%3Ctext x='35' y='45' font-size='20' fill='%23ddd6fe' opacity='0.3'%3E√ó%3C/text%3E%3Ctext x='15' y='50' font-size='18' fill='%23fce7f3' opacity='0.3'%3E=%3C/text%3E%3C/svg%3E")`,
        backgroundSize: '60px 60px'
      }), []);

      const answerWidthCh = useMemo(() => {
        const len = (answer || '').length;
        return Math.min(Math.max(len + 1, 2), 10);
      }, [answer]);

      if (gameState === 'setup') {
        return (
          <div className="min-h-screen w-full bg-gradient-to-br from-purple-200 via-pink-200 to-blue-200 flex items-center justify-center p-4 sm:p-6 md:p-8" style={mathBg}>
            <div className="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-lg border-4 border-purple-400 relative overflow-hidden fade-in">
              <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400"></div>

              <div className="text-center mb-6 sm:mb-8">
                <div className="text-5xl sm:text-6xl mb-3 sm:mb-4">üî¢</div>
                <h1 className="text-3xl sm:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</h1>
                <p className="text-purple-600 font-bold text-base sm:text-lg">–í—ã–±–µ—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ —É—Ä–æ–≤–µ–Ω—å!</p>
              </div>

              <div className="mb-5 sm:mb-6 bg-gradient-to-r from-purple-100 to-pink-100 p-4 sm:p-6 rounded-2xl border-2 border-purple-300">
                <label className="block text-purple-800 font-bold mb-3 text-center text-base sm:text-lg">üéö –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</label>
                <select
                  value={difficulty}
                  onChange={(e) => setDifficulty(e.target.value)}
                  className="w-full text-lg font-black text-purple-700 bg-white border-4 border-purple-300 rounded-xl p-3 focus:outline-none focus:border-pink-500 shadow"
                >
                  <option value="easy">–õ—ë–≥–∫–∏–π</option>
                  <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                  <option value="hard">–°–ª–æ–∂–Ω—ã–π</option>
                </select>
                <div className="mt-3 text-center text-sm font-bold text-purple-700">
                  {difficulty === 'easy' ? '–ü—Ä–∏–º–µ—Ä—ã –ø–æ–ø—Ä–æ—â–µ' : difficulty === 'medium' ? '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å' : '–ü—Ä–∏–º–µ—Ä—ã —Å–ª–æ–∂–Ω–µ–µ'}
                </div>
              </div>

              <div className="mb-5 sm:mb-6 bg-gradient-to-r from-purple-100 to-pink-100 p-4 sm:p-6 rounded-2xl border-2 border-purple-300">
                <label className="block text-purple-800 font-bold mb-3 text-center text-base sm:text-lg">üéØ –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏?</label>
                <div className="grid grid-cols-2 gap-3">
                  {[
                    { key: 'multiply', label: '√ó', color: 'purple' },
                    { key: 'divide', label: '√∑', color: 'blue' },
                    { key: 'add', label: '+', color: 'green' },
                    { key: 'subtract', label: '‚àí', color: 'orange' }
                  ].map(({ key, label, color }) => (
                    <button
                      key={key}
                      onClick={() => toggleOperation(key)}
                      className={`py-3 sm:py-4 rounded-xl font-black text-xl sm:text-2xl transition-all transform hover:scale-105 ${
                        operations[key]
                          ? `bg-gradient-to-br from-${color}-500 to-${color}-600 text-white shadow-lg`
                          : `bg-white text-${color}-500 border-2 border-${color}-300`
                      }`}
                    >
                      {label}
                    </button>
                  ))}
                </div>
              </div>

              <div className="mb-5 sm:mb-6 bg-gradient-to-r from-purple-100 to-pink-100 p-4 sm:p-6 rounded-2xl border-2 border-purple-300">
                <label className="block text-purple-800 font-bold mb-3 text-center text-base sm:text-lg">üìù –°–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤?</label>
                <div className="text-center mb-4">
                  <span className="text-5xl sm:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600">{totalRounds}</span>
                </div>
                <input
                  type="range"
                  value={totalRounds}
                  onChange={(e) => setTotalRounds(parseInt(e.target.value))}
                  min="5"
                  max="50"
                  step="5"
                  className="w-full h-4 rounded-full appearance-none cursor-pointer"
                  style={{
                    background: `linear-gradient(to right, #a855f7 0%, #ec4899 ${(totalRounds - 5) / 45 * 100}%, #e9d5ff ${(totalRounds - 5) / 45 * 100}%, #fce7f3 100%)`
                  }}
                />
                <div className="flex justify-between text-sm text-purple-600 mt-2 font-semibold">
                  <span>5</span>
                  <span>25</span>
                  <span>50</span>
                </div>
              </div>

              <button
                onClick={startGame}
                className="w-full bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500 text-white text-xl sm:text-2xl font-black py-4 sm:py-5 rounded-2xl hover:from-purple-600 hover:via-pink-600 hover:to-purple-600 transition-all transform hover:scale-105 flex items-center justify-center gap-3 shadow-lg"
              >
                ‚ñ∂ –ü–û–ï–•–ê–õ–ò!
              </button>
            </div>
          </div>
        );
      }

      if (gameState === 'results') {
        const grade = percentage >= 90 ? 'üèÜ' : percentage >= 70 ? '‚≠ê' : percentage >= 50 ? 'üëç' : 'üí™';

        return (
          <div className="min-h-screen w-full bg-gradient-to-br from-purple-200 via-pink-200 to-blue-200 flex items-center justify-center p-4 sm:p-6 md:p-8" style={mathBg}>
            <div className="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-3xl border-4 border-purple-400 relative overflow-hidden fade-in">
              <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400"></div>

              <div className="text-center mb-6">
                <div className="text-7xl sm:text-8xl mb-4">{grade}</div>
                <h1 className="text-3xl sm:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2">–ò–≥—Ä–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∞!</h1>
                <p className="text-xl sm:text-2xl font-bold text-purple-600">
                  {percentage >= 90 ? '–û—Ç–ª–∏—á–Ω–æ!' : percentage >= 70 ? '–•–æ—Ä–æ—à–æ!' : percentage >= 50 ? '–ù–µ–ø–ª–æ—Ö–æ!' : '–ü—Ä–æ–¥–æ–ª–∂–∞–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è!'}
                </p>
              </div>

              <div className="grid grid-cols-3 gap-3 sm:gap-4 mb-6">
                <div className="bg-gradient-to-br from-green-400 to-emerald-500 rounded-2xl p-3 sm:p-4 text-center shadow-lg">
                  <div className="text-3xl sm:text-4xl font-black text-white">{firstTryCorrectCount}</div>
                  <div className="text-xs sm:text-sm font-bold text-white whitespace-nowrap">‚úì –° 1 —Ä–∞–∑–∞</div>
                </div>
                <div className="bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-3 sm:p-4 text-center shadow-lg">
                  <div className="text-3xl sm:text-4xl font-black text-white">{totalRounds}</div>
                  <div className="text-xs sm:text-sm font-bold text-white whitespace-nowrap">üìù –í—Å–µ–≥–æ</div>
                </div>
                <div className="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-3 sm:p-4 text-center shadow-lg">
                  <div className="text-3xl sm:text-4xl font-black text-white">{percentage}%</div>
                  <div className="text-xs sm:text-sm font-bold text-white whitespace-nowrap">üìä –ü—Ä–æ—Ü–µ–Ω—Ç</div>
                </div>
              </div>

              <div className="mb-6 max-h-80 overflow-y-auto bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-3 sm:p-4 border-2 border-purple-300">
                <h3 className="font-black text-purple-700 mb-3 text-center text-lg sm:text-xl">‚ú® –¢–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚ú®</h3>
                <div className="space-y-2">
                  {gameHistory.map((item, index) => (
                    <div key={index} className={`flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 py-3 px-3 sm:px-4 rounded-xl shadow-md font-bold text-base sm:text-lg ${
                      item.hadMistake ? 'bg-gradient-to-r from-red-100 to-rose-100 border-2 border-red-400' : 'bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-400'
                    }`}>
                      <span className="text-purple-900">
                        {index + 1}. {item.question} = {item.correctAnswer}
                      </span>
                      <div className="flex items-center gap-2 flex-wrap">
                        {item.hadMistake && item.wrongAnswers && item.wrongAnswers.length > 0 && (
                          <span className="text-xs sm:text-sm text-red-600 bg-red-50 px-2 py-1 rounded border border-red-300 whitespace-nowrap">
                            –ü–æ–ø—ã—Ç–∫–∏: {item.wrongAnswers.join(', ')}
                          </span>
                        )}
                        {item.solvedCorrectlyAfter !== undefined && (
                          <span className="text-xs sm:text-sm text-green-700 bg-green-50 px-2 py-1 rounded border border-green-300 whitespace-nowrap">
                            –ü–æ—Ç–æ–º –≤–µ—Ä–Ω–æ: {item.solvedCorrectlyAfter}
                          </span>
                        )}
                        <span className={`text-xl sm:text-2xl ${item.hadMistake ? 'text-red-600' : 'text-green-600'}`}>
                          {item.hadMistake ? '‚úó' : '‚úì'}
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <button
                onClick={resetGame}
                className="w-full flex items-center justify-center gap-2 bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500 text-white font-black py-4 sm:py-5 text-lg sm:text-xl rounded-2xl hover:from-purple-600 hover:via-pink-600 hover:to-purple-600 transition-all shadow-lg"
              >
                üîÑ –ò–ì–†–ê–¢–¨ –°–ù–û–í–ê!
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen w-full bg-gradient-to-br from-purple-200 via-pink-200 to-blue-200 flex items-center justify-center p-4 sm:p-6 md:p-8" style={mathBg}>
          <div className="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-2xl border-4 border-purple-400 relative overflow-hidden fade-in">
            <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400"></div>

            <div className="text-center mb-5 sm:mb-6">
              <div className="flex items-center justify-between mb-3">
                <button onClick={goHome} className="home-button text-3xl sm:text-4xl bg-transparent border-none cursor-pointer" title="–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é">üè†</button>
                <h1 className="text-xl sm:text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 flex-1 whitespace-nowrap">üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ üî¢</h1>
                <button onClick={() => setSoundEnabled(!soundEnabled)} className="text-2xl sm:text-3xl bg-transparent border-none cursor-pointer" title={soundEnabled ? '–í—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫' : '–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫'}>{soundEnabled ? 'üîä' : 'üîá'}</button>
              </div>
              <p className="text-purple-600 font-bold text-base sm:text-lg">–ü—Ä–∏–º–µ—Ä {currentRound + 1} –∏–∑ {totalRounds}</p>
            </div>

            <div className="grid grid-cols-3 gap-2 sm:gap-3 mb-5 sm:mb-6">
              <div className="bg-gradient-to-br from-green-400 to-emerald-500 rounded-2xl p-3 text-center shadow-lg">
                <div className="text-xl sm:text-2xl font-black text-white">{score}</div>
                <div className="text-xs font-bold text-white whitespace-nowrap">‚úì –í–µ—Ä–Ω–æ</div>
              </div>
              <div className="bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-3 text-center shadow-lg">
                <div className="text-xl sm:text-2xl font-black text-white">{currentRound}</div>
                <div className="text-xs font-bold text-white whitespace-nowrap">üìù –†–µ—à–µ–Ω–æ</div>
              </div>
              <div className="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-3 text-center shadow-lg">
                <div className="text-xl sm:text-2xl font-black text-white">{percentage}%</div>
                <div className="text-xs font-bold text-white">üìä</div>
              </div>
            </div>

            <div className="bg-gradient-to-br from-purple-100 via-pink-100 to-blue-100 rounded-3xl p-4 sm:p-6 mb-5 sm:mb-6 border-3 border-purple-300 shadow-xl">
              <div className="flex justify-center gap-3 mb-4">
                {[...Array(2)].map((_, i) => (
                  <span key={i} className="text-3xl sm:text-4xl">
                    {lives > i ? '‚ù§Ô∏è' : 'ü§ç'}
                  </span>
                ))}
              </div>

              <div className="text-center mb-5 sm:mb-6 bg-white p-4 sm:p-5 rounded-2xl border-3 border-purple-300 shadow-inner">
                <div className="flex items-center justify-center gap-2 sm:gap-3 flex-wrap">
                  <span className="text-4xl sm:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600">{num1}</span>
                  <span className="text-4xl sm:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600">{currentOperation}</span>
                  <span className="text-4xl sm:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600">{num2}</span>
                  <span className="text-4xl sm:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600">=</span>

                  <input
                    type="text"
                    inputMode="numeric"
                    pattern="[0-9-]*"
                    value={answer}
                    onChange={(e) => {
                      const value = e.target.value.replace(/[^0-9-]/g, '');
                      setAnswer(value);
                    }}
                    onKeyPress={handleKeyPress}
                    style={{ width: `${answerWidthCh}ch` }}
                    className="text-4xl sm:text-5xl text-center border-4 border-purple-400 rounded-xl p-2 focus:outline-none focus:border-pink-500 font-black text-purple-700 bg-yellow-50 shadow-lg"
                    placeholder="?"
                    autoFocus
                  />
                </div>
              </div>

              <button
                onClick={checkAnswer}
                disabled={answer === ''}
                className="w-full bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500 text-white text-lg sm:text-xl font-black py-3 sm:py-4 rounded-2xl hover:from-purple-600 hover:via-pink-600 hover:to-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 shadow-lg"
              >
                –ü–†–û–í–ï–†–ò–¢–¨ ‚ú®
              </button>
            </div>

            {message && (
              <div className={`text-center text-lg sm:text-xl font-black mb-4 p-3 sm:p-4 rounded-2xl border-3 shadow-lg ${
                message.includes('–ü—Ä–∞–≤–∏–ª—å–Ω–æ')
                  ? 'bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 border-green-400'
                  : message.includes('–ü–æ–¥—É–º–∞–π')
                  ? 'bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-700 border-yellow-400'
                  : 'bg-gradient-to-r from-red-100 to-rose-100 text-red-700 border-red-400'
              }`}>
                {message}
              </div>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(MultiplicationGame));
  </script>
</body>
</html>
